@page "/profile"

@using System
@using Banko.Client.Models
@using Banko.Client.Services
@using Banko.Client.Services.User
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization

@inject UserStateService UserState
@inject ISnackbar Snackbar
@inject LoadingService LoadingService
@inject AuthenticationStateProvider AuthStateProvider

@attribute [Authorize]

<PageTitle>Profile</PageTitle>

<MudCard Elevation="25" Class="pa-4 w-100">
  <MudGrid>
    <MudItem md="2" Class="justify-center">
      <MudAvatar Color="Color.Warning" Variant="Variant.Filled">
        <MudIcon Color="Color.Dark" Icon="@Icons.Custom.Uncategorized.Radioactive" Size="Size.Large" />
      </MudAvatar>
    </MudItem>
    <AuthorizeView>
      <Authorized>
        @{
          var userId = context.User.FindFirst(ClaimTypes.NameIdentifier)?.Value;
          var userName = context.User.Identity?.Name ?? "User";
          var email = context.User.FindFirst(ClaimTypes.Email)?.Value;
          var role = context.User.FindFirst(ClaimTypes.Role)?.Value;
          var createdAt = context.User.FindFirst(ClaimTypes.DateOfBirth)?.Value;
        }
        <MudItem md="6">
          <MudItem md="12">Id: @userId</MudItem>
          <MudItem md="12">Name: @userName</MudItem>
          <MudItem md="12">Email: @email</MudItem>
          <MudItem md="12">Role: @role</MudItem>
          <MudItem md="12">Created At: @createdAt</MudItem>
        </MudItem>
      </Authorized>
      <NotAuthorized>
        <MudText>Could not load profile data.</MudText>
      </NotAuthorized>
    </AuthorizeView>
  </MudGrid>
</MudCard>