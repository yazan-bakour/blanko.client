@using Banko.Client.Models.User
@inherits LayoutComponentBase

<MudLayout type="typeof(App)" render-mode="WebAssemblyPrerendered" param-InitialState="serializedUserStateJson">
  <MudAppBar Dense="true" Elevation="1">
    <MudContainer MaxWidth="MaxWidth.Large" Class="d-flex justify-end py-2">
      <AuthorizeView>
        <Authorized>
          <MudMenu Dense Variant="Variant.Text" Size="Size.Medium" Color="Color.Inherit">
            <ActivatorContent>
              <MudAvatar>
                <MudImage Src="@context.User.FindFirst("profilePictureDisplay")?.Value" />
              </MudAvatar>
            </ActivatorContent>

            <ChildContent>
              <MudMenu StartIcon="@Icons.Material.TwoTone.Settings" IconColor="Color.Primary" Label="Settings">
                <MudMenuItem Icon="@Icons.Material.TwoTone.DarkMode" IconColor="Color.Secondary" Label="Dark Theme" />
              </MudMenu>

              <MudDivider />

              <MudMenuItem Href="/" ForceLoad Icon="@Icons.Material.TwoTone.Login" IconColor="Color.Primary"
                Label="Sign In" />

              <MudMenuItem Href="/" ForceLoad Icon="@Icons.Material.TwoTone.Logout" IconColor="Color.Primary"
                Label="Sign Out" />

            </ChildContent>
          </MudMenu>
        </Authorized>
      </AuthorizeView>
    </MudContainer>
  </MudAppBar>
  <NavMenu @bind-Open="_open" />
  <MudMainContent Class="pb-16">
    <MudContainer MaxWidth="MaxWidth.Large" Class="mt-4" Style="@($"color:{Colors.LightBlue.Lighten1};")">
      @Body
    </MudContainer>
  </MudMainContent>
</MudLayout>

@code {
  private bool _open = true;

  private void ToggleDrawer()
  {
    _open = !_open;
  }
}
